```
ALB 
NLB
GLB
Sticky Sessions(Session Affinity)
SSL/TLS
ASG
```

# Scalability - can handle greater loads by adapting
## vertical scalability
- (UP)increasing "size" of instance eg) t2.micro -> m2.large
- common for non distributed systems -> DB
- RDS, ElastiCache..
- hardware limit
- scale up / down

## horizontal scalability(Elasticity
- increasing "number" of instance eg) 1 * t2.micro -> 2 * t2.micro
- disbributed systems
- wep application/ modern application
- EC2...
- scale out(+) / in(-)

# High Availability
- hand in had with horizontal scaling
- means running apps/systems at least 2 data centers( == AZ)
- to survice a data center loss
- passive -> RDS multi AZ
- active -> Horizontal scaling

# ELB
- health check
- 4types of LB
  1. Classic CLB - depreciated
  2. Application ALB
  3. Networt NLB
  4. Gateway GLB

## ALB
client -> ALB -> Target Group(1.EC2 2.EC2) -> ec2 Security Group -> allow alb in inbound rule
- layer 7(Http)
- routing
- great fit for MS or container-based app(ECS)
- target groups


## NLB(layer 4)
- TCP & UDP traffics
- milions of requests per seconds
- ultra-low latency
- "One static IP per AZ" 
- supports assigning Elastic IP
- health check -> TCP, HTTP, HTTPS

## GLB(Layer 3)
- firewalls, intrusion, ... payload manipulation..
- client -> GLB -> target Group -> GLB -> Application
- GENEVE protocol port 6081

# Sticky Sessions(Session Affinity)
- remember client1 connects to #1 EC2 and all requests go to #1EC2.
- Cookie used for stickiness has an expiration date
- Make sure the user doesn't lose his session data like login
- Causion : imbalance to the load over the backend EC2

## Sticky Sessions - Cookie Names
1. Application-based Cookie
- custom cookie : generated by target, unique name for each target group, NOT AWSALB...
- application cookie : generated by LB, cookie name is AWSALBAPP

3. Duration-based Cookie
- generated by LB
- name is AWSALB for ALB, AWSELB for CLB

# Cross-Zone Load Balancing
- each load balancer instance distributes **evenly** across all registered instances in all AZ
- #1 ALB(2-EC2) 50% , #2 ALB(8-EC2) 50%
- but **10 EC2 gets 10% EVENLY**

# Without Cross-Zone
- #1 ALB(2-EC2) 50% , #2 ALB(8-EC2) 50%
- 2-EC2 25% in #1 ALB and 8-EC2 6.25% in #2 ALB

# Cross-zone load balancing with ELB
1. ALB - enabled by default, no charges for inter AZ data
2. NLB - disabled by default, pay charges
3. CLB - disabled by default, no charges

# SSL(Secure Sockets Layer) / TLS(Transport Layer Security)
- SSL Certificate allows traffic between Clients and LB to be encrypted in transit
- used to encrypt connections
- TLS is newer version of SSL
- SSL certi has expiration date, and must be renewed!
- user ---https-> LB ---http over private vpc-> EC2
- ACM( Aws Certificate Manager)

## SNI(Server Name Indication) - important !
- solve the problem of loading multiple SSL onto one web server
- "Newer" protocol and requires the client to indicate the hostname of the target server in the initial SSL handshake
- Not working with CLB


# ELB with SSL
V1: CLB -> only one ssl, multiple CLB for multiple hostname with multiple ssl
V2: ALB -> support multiple listeners with multiple SSL, use SNI
V2: NLB -> support multiple listeners with multiple SSL, use SNi



# Connection Draining
- between 1 to 3600 seconds
- set to a low value if your requests are short

# Auto Scailing Group(ASG)
- scale out -> more
- scale in -> less
- Free !
- Minimum Capacity(ec2 * 2) - Desired Capacity - Maximum Capacity
- possible to scale an ash based on CloudWatch Alarms

## Auto Scaling Group Policies
1. Dynamic Scaling
1-1 Target Tracking Scaling -> CPU avg 40%
1-2 Simple / Step Scaling -> CloudWatch alarm is triggered(CPU > 70%), then add 2units..

2. Scheduled Scaling
2-1 based on Usage Pattern

3. Predictive Scaling
3-1 Analyze historical load -> Generate Forecast -> Schedule Scaling actions

## Good Metrics to scale on
1. CPUUtilization
2. RequestCountPerTarget
3. Average Network In/out
4. any custom


Quiz
1. ELB provides a static DNS name we can use in our application
-> only NLB provides both static DNS name and static IP. while, ALB provides a static DNS name but it does not provide a static IP.

2. Sticky Session enabled
-> the same client is always redirected to the same target ec2 instance.

3. to get client's ip address from ALB
-> you get only ipv4 private addresses of ALB...but you can get client's ip from X-Forwarded-For in header cuz alb adds it!

4. the highest performance and lowest latency -> NLB > ALB

5. ALB supports protocols -> HTTP, HTTPS, Websocket

6. ALB can route traffic to different TG based on -> URL Path, Hostname, HTTP headers, and Query Strings

7. For compliance Purposes, expose a fixed static ip address to end-users... so they can write firewall rules -> "NLB" -> one static ip address per AZ and you can attach an Elastic IP to it
ALB and CLB have a static DNS name..

8. Reserved Application Based Cookie names -> AWSALB, AWSALBAPP, AWSALBTG

9. SNI -> Server Name Indication allows you to expose multiple HTTPS applications each with its own SSL certificate on the same listener.

10. NLB supports TCP, HTTP, and HTTPS health check